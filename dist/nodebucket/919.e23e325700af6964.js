"use strict";(self.webpackChunknodebucket=self.webpackChunknodebucket||[]).push([[919],{4919:(U,c,r)=>{r.r(c),r.d(c,{SecurityModule:()=>S});var l=r(6814),a=r(157),e=r(9468);let d=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-security"]],decls:1,vars:0,template:function(n,o){1&n&&e._UZ(0,"router-outlet")},dependencies:[a.lC],encapsulation:2})}return t})();var i=r(95),p=r(459),g=r(9862);let h=(()=>{class t{constructor(s){this.http=s}findEmployeeById(s){return console.log("Finding employee by ID",s),this.http.get("/api/employees/"+s)}static#e=this.\u0275fac=function(n){return new(n||t)(e.LFG(g.eN))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function f(t,u){if(1&t&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&t){const s=e.oxw();e.xp6(1),e.hij(" ",s.errorMessage," ")}}function y(t,u){1&t&&(e.TgZ(0,"span"),e._uU(1,"Log In"),e.qZA())}function v(t,u){1&t&&(e.TgZ(0,"div"),e._UZ(1,"span",18),e._uU(2," Loading... "),e.qZA())}const b=[{path:"",component:d,title:"Nodebucket: Security",children:[{path:"signin",component:(()=>{class t{constructor(s,n,o,m,Z){this.fb=s,this.route=n,this.router=o,this.cookieService=m,this.securityService=Z,this.isLoading=!1,this.signInForm=this.fb.group({empId:[null,i.kI.compose([i.kI.required,i.kI.pattern("^[0-9]*$")])]}),this.errorMessage="",this.sessionUser={}}signIn(){console.log("Signing in..."),this.isLoading=!0;const s=this.signInForm.controls.empId.value;if(console.log(s),!s||isNaN(parseInt(s,10)))return console.error("The employee ID is invalid."),this.errorMessage="The employee ID is invalid. Please try again.",void(this.isLoading=!1);console.log("Pass the if check for the empId"),this.securityService.findEmployeeById(s).subscribe({next:n=>{console.log("looking for employee by id",n),this.sessionUser=n,this.cookieService.set("session_user",s,1),this.cookieService.set("session_name",`${n.firstName} ${n.lastName}`,1),localStorage.setItem("session_user",JSON.stringify(n)),localStorage.setItem("session_name",`${n.firstName} ${n.lastName}`);const o=this.route.snapshot.queryParamMap.get("returnUrl")||"/";console.log("returning to",o),this.router.navigate([o])},error:n=>{this.isLoading=!1,this.errorMessage=n.error.message?n.error.message:n.message}})}static#e=this.\u0275fac=function(n){return new(n||t)(e.Y36(i.qu),e.Y36(a.gz),e.Y36(a.F0),e.Y36(p.N),e.Y36(h))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-signin"]],decls:29,vars:4,consts:[[1,"row","justify-content-center","mt-5"],[1,"col-lg-4","col-md-6","col-sm-6"],[1,"card","shadow"],[1,"card-title","text-center","border-bottom"],[1,"p-2","dark-green"],["src","../../../assets/Slytherin.png","alt","Slytherin Logo",1,"signin-logo"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["for","empId",1,"form-label"],["type","text","id","empId","formControlName","empId",1,"form-control"],[1,"text-danger","fst-italic","misc"],["class","alert alert-danger error-message","role","alert",4,"ngIf"],[1,"d-grid"],["type","submit",1,"btn","background-green","white","fw-bold"],[4,"ngIf"],["type","button","routerLink","/",1,"btn","background-green","white","fw-bold"],["role","alert",1,"alert","alert-danger","error-message"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(n,o){1&n&&(e._UZ(0,"br")(1,"br")(2,"br")(3,"br"),e.TgZ(4,"div")(5,"div",0)(6,"div",1)(7,"div",2)(8,"div",3)(9,"h2",4),e._uU(10,"Employee Sign In"),e.qZA(),e._UZ(11,"img",5),e.qZA(),e.TgZ(12,"div",6)(13,"form",7),e.NdJ("ngSubmit",function(){return o.signIn(),o.signInForm.reset()}),e.TgZ(14,"div",8)(15,"label",9),e._uU(16,"Enter Employee ID"),e.qZA(),e._UZ(17,"input",10),e.TgZ(18,"span",11),e._uU(19,"(Slytherin employees only!)"),e.qZA()(),e.YNc(20,f,2,1,"div",12),e._UZ(21,"br"),e.TgZ(22,"div",13)(23,"button",14),e.YNc(24,y,2,0,"span",15),e.YNc(25,v,3,0,"div",15),e.qZA(),e._UZ(26,"br"),e.TgZ(27,"button",16),e._uU(28,"Return to Home Page"),e.qZA()()()()()()()()),2&n&&(e.xp6(13),e.Q6J("formGroup",o.signInForm),e.xp6(7),e.Q6J("ngIf",o.errorMessage),e.xp6(4),e.Q6J("ngIf",!o.isLoading),e.xp6(1),e.Q6J("ngIf",o.isLoading))},dependencies:[l.O5,a.rH,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u],styles:[".misc[_ngcontent-%COMP%]{font-size:14px;opacity:.8}.error-message[_ngcontent-%COMP%]{width:85%;margin:0 auto;padding-bottom:10px;font-size:.8rem}"]})}return t})(),title:"Nodebucket: Sign In"}]}];let I=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[a.Bz.forChild(b),a.Bz]})}return t})(),S=(()=>{class t{static#e=this.\u0275fac=function(n){return new(n||t)};static#t=this.\u0275mod=e.oAB({type:t});static#n=this.\u0275inj=e.cJS({imports:[l.ez,I,i.u5,i.UX,g.JF,a.Bz]})}return t})()}}]);